<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ArkTS éªŒè¯è¶‹åŠ¿å›¾</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 20px;
      min-height: 100vh;
    }
    .container {
      max-width: 1400px;
      margin: 0 auto;
    }
    h1 {
      color: white;
      text-align: center;
      margin-bottom: 30px;
      font-size: 2.5em;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }
    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    .stat-card {
      background: white;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      transition: transform 0.2s;
    }
    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 12px rgba(0,0,0,0.15);
    }
    .stat-label {
      color: #666;
      font-size: 0.9em;
      margin-bottom: 5px;
    }
    .stat-value {
      font-size: 2em;
      font-weight: bold;
      color: #333;
    }
    .stat-trend {
      font-size: 0.85em;
      margin-top: 5px;
    }
    .trend-up { color: #10b981; }
    .trend-down { color: #ef4444; }
    .chart-container {
      background: white;
      border-radius: 12px;
      padding: 30px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    .chart-wrapper {
      position: relative;
      height: 400px;
    }
    .footer {
      text-align: center;
      color: white;
      margin-top: 20px;
      font-size: 0.9em;
      opacity: 0.8;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ“Š ArkTS éªŒè¯è¶‹åŠ¿åˆ†æ</h1>
    
    <div style="background: white; border-radius: 12px; padding: 20px; margin-bottom: 30px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
      <label style="font-weight: bold; color: #333; margin-right: 10px;">ğŸ“ é€‰æ‹©ç›®å½•:</label>
      <select id="dirSelector" style="padding: 10px 15px; border-radius: 8px; border: 2px solid #667eea; font-size: 1em; cursor: pointer; background: white; min-width: 300px;">
        <option value="/Users/million_mo/projects/hmos_projects/hmosworld/" >/Users/million_mo/projects/hmos_projects/hmosworld/</option><option value="./examples" selected>./examples</option><option value="test/" >test/</option>
      </select>
      <span style="margin-left: 15px; color: #666; font-size: 0.9em;">å…± <span id="totalRuns">30</span> æ¬¡éªŒè¯</span>
    </div>
    
    <div class="stats">
      <div class="stat-card">
        <div class="stat-label">æœ€æ–°é€šè¿‡ç‡</div>
        <div class="stat-value" id="statPassRate">66.67%</div>
        <div class="stat-trend trend-down" id="statPassRateTrend">
          â†“ 0.00%
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-label">æ€»æ–‡ä»¶æ•°</div>
        <div class="stat-value" id="statTotal">24</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">æœ€æ–°é€šè¿‡æ•°</div>
        <div class="stat-value" style="color: #10b981;" id="statPassed">16</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">æœ€æ–°å¤±è´¥æ•°</div>
        <div class="stat-value" style="color: #ef4444;" id="statFailed">8</div>
      </div>
    </div>

    <div class="chart-container">
      <h2 style="margin-bottom: 20px; color: #333;">é€šè¿‡ç‡è¶‹åŠ¿</h2>
      <div class="chart-wrapper">
        <canvas id="passRateChart"></canvas>
      </div>
    </div>

    <div class="chart-container">
      <h2 style="margin-bottom: 20px; color: #333;">æ–‡ä»¶æ•°é‡è¶‹åŠ¿</h2>
      <div class="chart-wrapper">
        <canvas id="filesChart"></canvas>
      </div>
    </div>

    <div class="footer">
      æœ€åæ›´æ–°: 2025/10/20 14:28:26
    </div>
  </div>

  <script>
    // æ‰€æœ‰ç›®å½•çš„æ•°æ®
    const allData = {"/Users/million_mo/projects/hmos_projects/hmosworld/":{"labels":["10/17 15:08","10/17 15:34","10/17 15:43","10/17 16:44","10/17 17:07","10/18 11:44","10/18 11:58","10/18 12:59","10/20 11:19","10/20 11:34","10/20 11:56","10/20 12:16"],"passRateData":[30.86,38.29,40.57,44,46.29,52,54.29,61.71,73.71,76,81.71,86.29],"passedData":[54,67,71,77,81,91,95,108,129,133,143,151],"failedData":[121,108,104,98,94,84,80,67,46,42,32,24],"totalData":[175,175,175,175,175,175,175,175,175,175,175,175],"count":12,"latest":{"timestamp":"2025-10-20T04:16:35.855Z","datetime":"2025/10/20 12:16:35","targetDir":"/Users/million_mo/projects/hmos_projects/hmosworld/","total":175,"passed":151,"failed":24,"passRate":"86.29"},"previous":{"timestamp":"2025-10-20T03:56:54.501Z","datetime":"2025/10/20 11:56:54","targetDir":"/Users/million_mo/projects/hmos_projects/hmosworld/","total":175,"passed":143,"failed":32,"passRate":"81.71"}},"./examples":{"labels":["10/17 15:53","10/17 15:55","10/18 12:34","10/18 12:39","10/18 12:52","10/18 12:53","10/18 12:53","10/18 12:57","10/18 14:57","10/20 10:22","10/20 10:33","10/20 10:39","10/20 10:40","10/20 10:40","10/20 10:45","10/20 11:10","10/20 11:13","10/20 11:16","10/20 11:18","10/20 11:49","10/20 11:49","10/20 11:55","10/20 11:55","10/20 11:56","10/20 12:02","10/20 12:07","10/20 12:07","10/20 14:23","10/20 14:26","10/20 14:28"],"passRateData":[34.78,34.78,43.48,43.48,34.78,34.78,34.78,34.78,34.78,34.78,34.78,37.5,37.5,37.5,37.5,45.83,45.83,45.83,45.83,58.33,58.33,58.33,58.33,58.33,62.5,62.5,62.5,66.67,66.67,66.67],"passedData":[8,8,10,10,8,8,8,8,8,8,8,9,9,9,9,11,11,11,11,14,14,14,14,14,15,15,15,16,16,16],"failedData":[15,15,13,13,15,15,15,15,15,15,15,15,15,15,15,13,13,13,13,10,10,10,10,10,9,9,9,8,8,8],"totalData":[23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24],"count":30,"latest":{"timestamp":"2025-10-20T06:28:25.559Z","datetime":"2025/10/20 14:28:25","targetDir":"./examples","total":24,"passed":16,"failed":8,"passRate":"66.67"},"previous":{"timestamp":"2025-10-20T06:26:14.294Z","datetime":"2025/10/20 14:26:14","targetDir":"./examples","total":24,"passed":16,"failed":8,"passRate":"66.67"}},"test/":{"labels":["10/20 12:08","10/20 12:08","10/20 12:15","10/20 12:16"],"passRateData":[74.04,74.04,77.39,77.39],"passedData":[77,77,89,89],"failedData":[27,27,26,26],"totalData":[104,104,115,115],"count":4,"latest":{"timestamp":"2025-10-20T04:16:04.132Z","datetime":"2025/10/20 12:16:04","targetDir":"test/","total":115,"passed":89,"failed":26,"passRate":"77.39"},"previous":{"timestamp":"2025-10-20T04:15:59.242Z","datetime":"2025/10/20 12:15:59","targetDir":"test/","total":115,"passed":89,"failed":26,"passRate":"77.39"}}};
    let currentChart1, currentChart2;
    
    // åˆå§‹åŒ–å›¾è¡¨
    function initCharts(dirKey) {
      const data = allData[dirKey];
      
      // æ›´æ–°ç»Ÿè®¡å¡ç‰‡
      document.getElementById('statPassRate').textContent = data.latest.passRate + '%';
      document.getElementById('statTotal').textContent = data.latest.total;
      document.getElementById('statPassed').textContent = data.latest.passed;
      document.getElementById('statFailed').textContent = data.latest.failed;
      document.getElementById('totalRuns').textContent = data.count;
      
      // æ›´æ–°è¶‹åŠ¿æŒ‡æ ‡
      const trendElement = document.getElementById('statPassRateTrend');
      if (data.previous) {
        const diff = parseFloat(data.latest.passRate) - parseFloat(data.previous.passRate);
        const isUp = diff > 0;
        trendElement.className = 'stat-trend ' + (isUp ? 'trend-up' : 'trend-down');
        trendElement.textContent = (isUp ? 'â†‘' : 'â†“') + ' ' + Math.abs(diff).toFixed(2) + '%';
      } else {
        trendElement.textContent = '-';
      }
      
      // é”€æ¯æ—§å›¾è¡¨
      if (currentChart1) currentChart1.destroy();
      if (currentChart2) currentChart2.destroy();
      
      // åˆ›å»ºé€šè¿‡ç‡è¶‹åŠ¿å›¾
      const passRateCtx = document.getElementById('passRateChart').getContext('2d');
      currentChart1 = new Chart(passRateCtx, {
      type: 'line',
      data: {
        labels: data.labels,
        datasets: [{
          label: 'é€šè¿‡ç‡ (%)',
          data: data.passRateData,
          borderColor: 'rgb(16, 185, 129)',
          backgroundColor: 'rgba(16, 185, 129, 0.1)',
          borderWidth: 3,
          tension: 0.4,
          fill: true,
          pointRadius: 5,
          pointHoverRadius: 7,
          pointBackgroundColor: 'rgb(16, 185, 129)',
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: { display: true, position: 'top' },
          tooltip: {
            callbacks: {
              label: function(context) {
                return context.dataset.label + ': ' + context.parsed.y.toFixed(2) + '%';
              }
            }
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            max: 100,
            ticks: {
              callback: function(value) { return value + '%'; }
            }
          }
        }
      }
    });

      // åˆ›å»ºæ–‡ä»¶æ•°é‡è¶‹åŠ¿å›¾
      const filesCtx = document.getElementById('filesChart').getContext('2d');
      currentChart2 = new Chart(filesCtx, {
      type: 'bar',
      data: {
        labels: data.labels,
        datasets: [
          {
            label: 'âœ… é€šè¿‡',
            data: data.passedData,
            backgroundColor: 'rgba(16, 185, 129, 0.8)',
            borderColor: 'rgb(16, 185, 129)',
            borderWidth: 1
          },
          {
            label: 'âŒ å¤±è´¥',
            data: data.failedData,
            backgroundColor: 'rgba(239, 68, 68, 0.8)',
            borderColor: 'rgb(239, 68, 68)',
            borderWidth: 1
          }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: { display: true, position: 'top' },
          tooltip: {
            mode: 'index',
            intersect: false
          }
        },
        scales: {
          x: { stacked: false },
          y: { stacked: false, beginAtZero: true }
        }
      }
    });
    }
    
    // ç›®å½•åˆ‡æ¢äº‹ä»¶
    document.getElementById('dirSelector').addEventListener('change', function(e) {
      initCharts(e.target.value);
    });
    
    // åˆå§‹åŒ–é»˜è®¤ç›®å½•
    initCharts('./examples');
  </script>
</body>
</html>